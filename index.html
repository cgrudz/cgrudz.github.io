<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF8">
  <title> 115KV_network_reduction_visualization </title>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.7.0/vis.min.js"></script>
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.7.0/vis.min.css">
  <link type="text/css" rel="stylesheet" href="115visualization.css">  
  <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">

  <script src="115V_D1_data.js"></script>
  <script src="position.js"></script>
  
</head>

<body >
<div style="font-family: Arial;">
    <h1 class="centered"> 115KV and Above Network Reduction Visualization </h1>
    <div style="margin-left:5%; margin-right:5%;">                 
        <h2> Description of Reduction: </h2>
        <p> 
        This is the visualization of the reduction main connected component threshold network of voltage
        greater than or equal to 115KV.  The buses with voltage under the threshold are removed and the remaining
        network has 24,628 buses; the largest connected component contains all but 477 buses, or 24,151 in total.
        We apply the degree one reduction recursively to this large connected component to obtain a network of 18,032
        buses which is visualized below.
        </p>
        <p>
        The full network, not including disconnected buses or those of nominal voltage zero, contains 53,843 buses;
        of these there are 29,215 buses with nominal voltage between zero and 115KV.  The network consisting of only these
        29,215 buses has 6,678 connected components, 4,862 of these are of size one. Of the remaining connected components
        26 have more than 100 buses, of these 7 have more than 500 buses, and 3 have more than 1000 buses with 1320, 1576 
        and 4931 buses respectively.  There are 3655 generators below the 115 KV threshold, and these account for 596,870 MV of generation.
        </p>
        <h2> Colors and Labels </h2>
        <p>
        The buses in the network are colored and sized according to their voltage window, ascending in size with voltage
        and colors corresponding to the visualization key below. 
        For the collapsed trees where the choice of color is ambiguous, the maximum voltage for
        any bus in the collapsed tree is chosen to be the representative voltage for this node.
        Nodes with generators are always colored according to the generator scheme.
        </p>
        <p>
        The buses are labeled in this visualization with the arbitrary bus numbering, 1 to 24,628, assigned to the buses
        of the large connected component with respect to the above reduction.  Trees additionally list "B*" where the
        * is the number of buses contained within the reduction to this terminal node.        
        Generator nodes are labeled with a
        value of the megawatts, equal to the sum of the value GMV for each generator in the
        node - note, there are some zero and negative values in the original data.
        </p>        
        <p>
    </div>
</div>
<div style="height:100%; width:100%; position:absolute; font-family: Arial;">
    <div id="mynetwork"></div>
    <div id="config_box" style="float:left; margin-left:5%; width:500px;"> </div>
    <div style="float:right; margin-right:5%; margin-top:50px;">
    <table class="vis_key">
        <thead>
            <tr>
                <th colspan="6"> <h3 class="centered">Visualization Key</h3></th>
            </tr>
        </thead>        
        <tr>
            <td colspan="6" > <h4>Colors:</h4> </td> 
        </tr>                    
        <tr>
            <td > 
                <div class="color_bubble" style="background-color: #FF00FF;"></div>
                <div class="text_bubble"> 115<= KV <138 </div>
            </td>
            <td > 
                <div class="color_bubble" style="background-color: #000080;"></div>
                <div class="text_bubble"> 138<= KV <230 </div>
            </td>
            <td > 
                <div class="color_bubble" style="background-color: #00B200;"></div>
                <div class="text_bubble"> 230<= KV <345 </div>
            </td>
            <td > 
                <div class="color_bubble" style="background-color: #FF8C00;"></div>
               <div class="text_bubble"> 345<= KV <500 </div>
            </td>
            <td >             
                <div class="color_bubble" style="background-color: #FF0000;"></div>
                <div class="text_bubble"> 500<= KV  </div>                   
            </td>
            <td > 
                <div class="color_bubble" style="background-color: #800000;"></div>
                <div class="text_bubble"> Generator </div>      
            </td>            
        </tr>
        <tr> <td colspan="6"><h4> Node Symbols: </h4> </td></tr>
        <tr >    
            <td > 
                <i class="ion-network" id="network" ></i> 
                <div class="text_bubble"> </div>
            </td>
            <td colspan="5"> This represents the terminal node of a collapsed tree in the degree one reduction</td>             
        </tr>
        
    </table>
    </div>
    <div style="margin-top:10px; margin-right:5%; margin-bottom:50px; margin-left: 5%; float:left; clear: both;">
        <h2> Description of Visualization Model: </h2>
        <p>
        The x and y coordinates in this visualization are preloaded from the "stable" state of a long previous run;  
        the positions are initialized in the script "position.js", and the initialization can be disabled by removing
        this line in the header of the HTML file.
        Due to the interactions of the tightly knit nodes, the model doesn't truly converge, but this appears to be
        a representative layout for the network. The physics are by default disabled but can be enabled with the 
        configuration box.
        </p>
        
        <p> 
        The evolution of the nodes is governed by a repulsion attraction model in which nodes repulse and edges
        attract. Physics model for the visualization is set by default to the 
        <a href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0098679"> ForceAtlas2 Model </a>
        and the solver is based partially on the equations provided in the model and the Barnes-Hut algorithm for n-body
        problems.  A full description of the physics options is found in the 
        <a href="http://visjs.org/docs/network/physics.html#">Vis.js documentation</a>, and summaries of the
        parameters are provided below. <b>Note: the physics can be enabled or disabled with the button in the parameter
        slider</b>
        </p>
        <table>
            <th colspan="2"> <h3> Parameter Descriptions </h3> </th>
            <tr>
            <td> gravitationalConstant </td> 
            <td> 
            This represents the gravitational constant for the attraction/ repulsion between nodes; 
            the nodes are intended to repulse, so the constant is negative and if you want the repulsion to be stronger, 
            decrease the value.
            </td>
            </tr>
            <tr>
            <td> centralGravity </td>
            <td> 
            This parameter affects the strength of the central attractor for the system - when turned on, the
            gravity will pull the entire network towards the center with the same force irrespective of the distance
            from the center.
            </td>
            </tr>
            <tr>
            <td> springLength </td>
            <td> This parameter describes the rest length of the springs.</td>
            </tr>
            <tr>
            <td> springConstant </td>
            <td> This is a measure of spring stiffness, with higher values meaning stiffer springs </td>
            </tr>
            <tr>
            <td> damping </td>
            <td> 
            The damping factor is how much of the velocity from the previous iteration of the physics simulation 
            carries over to the next iteration.
            </td>
            <tr>
            <td> avoidOverlap </td>
            <td> 
            When larger than 0, the size of the node is taken into account. The distance will be calculated from 
            the radius of the encompassing circle of the node for both the gravity models. Value 1 is maximum overlap 
            avoidance. <b> Note: this overrides the centralGravity setting, and will turn it back on if it is off</b>.
            </td>
            </tr>
            <tr>
            <td> maximumVelocity </td>
            <td>
            This limits the velocity the nodes can achieve in the simulation and slows down the stabilization of the model
            </td>
            </tr>
            <tr>
            <td> minimumVelocity </td>
            <td> 
            This sets the threshold velocity that, if all nodes in the network fall under, the network is considered
            stabilized and the model stops.
            </td>
            </tr>
            <tr>
            <td> solver </td>
            <td> 
            The solver is set by default to the forceAtlas2 model and in principle can be changed, but it is better 
            to change the model for a fresh run within the options of the scripts.
            </td>
            </tr>
            <tr>
            <td> timeStep </td>
            <td> 
            This sets the time step for the discretization of the physics; if it is too large the simulation will
            become unstable.
            </td>
            </tr>
        </table>
    </div>
    <div style="position: relative; clear: both;" class="centered" >
        <h4> 
        This visualization is performed in <a href="http://visjs.org">Vis.js</a> Copyright (C) 2010-2015 Almende B.V., 
        dual licensed under Apache 2.0 and MIT
        </h4>
    </div>
</div>


<script type="text/javascript">

  var network;
  
  var config_box = document.getElementById('config_box')
  var container = document.getElementById('mynetwork');
  
  var data = {
      nodes: nodes,
      edges: edges
    };
 
  var options = {      
      nodes: {
        shape: 'dot',
        scaling: {
          min: 10,
          max: 30
        },
        font: {
          size: 100,
          face: 'Tahoma'
        }
      },
      edges: {
        width: 0.15,
        color: {inherit: 'from'},
        smooth: {
          type: 'continuous'
        }
      },
      physics: {
        enabled: false,
        forceAtlas2Based: {
          gravitationalConstant: -500,
          centralGravity: 0,
          springLength: 230,
          springConstant: 2.0,
          damping: .05,
          avoidOverlap: 0.0,
          },
        maxVelocity: 5000,
        solver: 'forceAtlas2Based',
        timestep: 0.35,
        stabilization: {iterations:300}
        },
      configure: { 
        enabled: true,
        filter: 'physics',
        showButton: false,
        container: config_box
        },
      interaction: {
        tooltipDelay: 200,
        hideEdgesOnDrag: false
      },
      layout: {
        randomSeed: undefined,
        hierarchical: {
          enabled:false,
          levelSeparation: 150,
          direction: 'UD',   // UD, DU, LR, RL
          sortMethod: 'hubsize' // hubsize, directed
            }
          },
      groups: {
          'tree1': {
            shape: 'icon',
            icon: {
              face: 'Ionicons',
              code: '\uf341',
              size: 300,
              color: '#FF00FF',
              }
            },
          'tree2': {
            shape: 'icon',
            icon: {
              face: 'Ionicons',
              code: '\uf341',
              size: 250,
              color: '#000080',
              }
            },
          'tree3': {
            shape: 'icon',
            icon: {
              face: 'Ionicons',
              code: '\uf341',
              size: 350,
              color: '#00B200',
              }
            },
          'tree4': {
            shape: 'icon',
            icon: {
              face: 'Ionicons',
              code: '\uf341',
              size: 400,
              color: '#FF8C00',
              }
            },
          'tree5': {
            shape: 'icon',
            icon: {
              face: 'Ionicons',
              code: '\uf341',
              size: 600,
              color: '#FF0000',
              }
            },
          'gTree': {
            shape: 'icon',
            icon: {
              face: 'Ionicons',
              code: '\uf341',
              size: 600,
              color: '#800000'            
              }
            },
          'bus1': {
            size: 20,
            color: '#FF00FF',
            },
          'bus2': {
            size: 60,
            color: '#000080',
            },
          'bus3': {
            size: 100,
            color: '#00B200',
            },
          'bus4': {
            size: 140,
            color: '#FF8C00',
            },
          'bus5': {
            size: 180,
            color: '#FF0000',
            },
          'gen' : {
            size: 180,
            color: '#800000',
            }
          }       
   };

  network = new vis.Network(container, data, options);

  redraw()
  
</script>

</body>
</html>
